{% extends "subcale.html" %}

{% block extra_content %}
<style>
  #radio-widget button.active {
    background-color: #06d6a0;
    color: white;
    font-weight: bold;
  }
</style>
<meta name="viewport" content="width=device-width, initial-scale=0.3">
<div style="display: flex; justify-content: center; align-items: flex-start; gap: 30px; margin-bottom: 30px;">
  <div class="subcale-grid">
    <!-- Calecho photo (left column) -->
    <div>
      <img src="{{ url_for('static', filename='images/calecho.jpg') }}" alt="calecho image" style="width: 350px; height: auto;">
    </div>

    <!-- Music text and radio (center column) -->
    <div>
      <div class="subcale-text">
        {{ music_text | safe }}
      </div>
      <div id="radio-widget" >
        <h3>ðŸŽ§ Calecho Radio</h3>
        <div style="margin-bottom: 10px;">
          <button onclick="setStation('latin')">Latin</button>
          <button onclick="setStation('pop')">Pop</button>
          <button onclick="setStation('classic')">Classic</button>
          <button onclick="setStation('turk')">Turk</button>
          <button onclick="setStation('rb')">R&amp;B</button>
        </div>
        <audio id="radio-player" controls style="width: 100%;">
          <source id="radio-source" src="" type="audio/mpeg">
          Your browser does not support the audio element.
        </audio>
      </div>
    </div>

    <!-- Music of the day photo (right column) -->
    <div>
      <img src="{{ url_for('static', filename='images/music_of_the_day.jpg') }}" alt="Music of the day image" style="width: 350px; height: auto; border-radius: 8px;">
    </div>

  </div>
</div>
{% endblock %}

{% block body_text %}
<p style="text-align: center; margin: 0 auto 40px auto; max-width: 600px;">
  ðŸŽ§ Welcome to Calecho â€” the community's radio space for sharing music, rhythms, and cultural vibes from around the world!
</p>
{% endblock %}

{% block scripts %}
<script>
  console.log("ðŸ“» calecho.js loaded");
  const stations = {
      latin: 'https://stream.0nlineradio.com/latin?ref=radiobrowser',
      pop: 'https://0n-hits.radionetz.de/0n-hits.mp3',
      classic: 'https://wwfm.streamguys1.com/live-mp3',
      turk: 'https://23543.live.streamtheworld.com/JOY_TURK.mp3',
      rb: 'http://media-the.musicradio.com/CapitalXTRALondonMP3'
    };

    function setStation(name) {
      const player = document.getElementById('radio-player');
      const source = document.getElementById('radio-source');
      source.src = stations[name];
      player.load();
      player.play().catch(e => console.log("Autoplay blocked:", e));

      // Highlight the active button
      const buttons = document.querySelectorAll('#radio-widget button');
      buttons.forEach(btn => btn.classList.remove('active'));
      const activeBtn = Array.from(buttons).find(btn => btn.textContent.toLowerCase() === name.toLowerCase());
      if (activeBtn) activeBtn.classList.add('active');
    }
</script>
{% endblock %}
