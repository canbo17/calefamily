<div>
    {% if session.get('user_id') %}
    <a href="{{ url_for('home') }}" style="background-color: #118ab2; padding: 10px 15px; border-radius: 10px; color: white; text-decoration: none;">🏡 Go Home</a>            
    <a href="{{ url_for('calengineers') }}" style="background-color: #ef476f; padding: 10px 15px; border-radius: 10px; color: white; text-decoration: none;">🛠️ Calengineers</a>
    <a href="{{ url_for('inbox') }}" style="background-color: #d577ea; padding: 10px 15px; border-radius: 10px; color: white; text-decoration: none; margin-right:8px;">
        📬 Inbox
        {% if unread_count > 0 %}
        <span style="background-color: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px;">
            {{ unread_count }}
        </span>
        {% endif %}
        <a href="{{ url_for('profile') }}" style="background-color: #06d6a0; padding: 10px 15px; border-radius: 10px; color: white; text-decoration: none;">
        <img src="{{ url_for('static', filename='images/user_' ~ session['user_id'] ~ '.jpg') }}"
            onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/default.jpg') }}';"
            alt="Profile" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 6px; vertical-align: middle;">
        Profile
        </a>
    {% endif %}
</div>
<h1>{% if original_message_content %}Reply to Message{% else %}Send Message to {{ recipient }}{% endif %}</h1>

{% if original_message_content %}
    <p><b>Original Message:</b></p>
    <p>{{ original_message_content }}</p>
    <hr>
{% endif %}

<form method="POST" action="{{ url_for('send_messages', recipient_id=recipient_id) }}">
    <textarea name="message_content" rows="5" cols="40" placeholder="Write your message..." required></textarea><br><br>
    <input type="submit" value="{% if original_message_content %}Send Reply{% else %}Send Message{% endif %}" 
           style="background-color: #06d6a0; color: white; padding: 10px 15px; border-radius: 10px;">
</form>

<hr>

<h1>Sent Messages</h1>
<table border="1">
    <tr>
        <th>Recipient</th>
        <th>Message</th>
        <th>Timestamp</th>
    </tr>
    {% for message in messages %}
        <tr>
            <td>{{ message[0] }}</td>
            <td>{{ message[1] }}</td>
            <td>{{ message[2] }}</td>
        </tr>
    {% endfor %}
</table>